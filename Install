#!/bin/sh

# Name: Install
# Purpose: install script for the femover product

# remember the top-level directory

cd `dirname $0`

# if no Configuration file, bail out

if [ ! -f Configuration ]; then
	echo "Missing Configuration file"
	exit 1
fi

# source the Configuration file

. Configuration
echo "Sourced Configuration file"

# add/update links to config.py library

CONFIG=lib/python/config.py

for dir in gather control schema
do
	if [ -h ${dir}/config.py ]; then
		rm ${dir}/config.py
	fi
	if [ -f ${dir}/config.pyc ]; then
		rm ${dir}/config.pyc
	fi
	ln -s ${CONFIG} ${dir}/config.py 
	echo "Created symlink: ${dir}/config.py"
done

# if we don't have a data and a logs directory, make them

if [ ! -d ${DATA_DIR} ]; then
	mkdir -p ${DATA_DIR}
	echo "Created data directory: ${DATA_DIR}"
fi

if [ ! -d ${LOG_DIR} ]; then
	mkdir ${LOG_DIR}
	echo "Created log directory: ${LOG_DIR}"
fi

# update permissions on gatherers and controllers

chmod ug+x gather/*Gatherer.py control/*
echo "Granted execute permissions for gatheres and control scripts"

echo "Finished"
